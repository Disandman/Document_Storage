## Ревью от 31.07.2021

Развернула приложение, посмотрела код. Всё отлично получается, вы молодец) Приложение очень приятное.

__Из недостатков:__

1. RBAC есть, но он не везде настроен. Например, [вот эта страница](https://projectsil.ru/chart/index-alt) скрыта для гостей должна бы быть, но я могу её открыть по прямой ссылке, не авторизуясь в системе.

Обычно делают доступ по белому списку. Т.е. изначально все страницы скрыты (кроме роли "разработчик", если такая есть). Затем создаются разрешения rbac, а для публичных страниц указывается массив таких страниц (прикладываю скрин с примером ниже, 'as access' - это прикрепленное поведение, [почитать можно тут](http://www.yiiframework.com/doc-2.0/guide-concept-behaviors.html#attaching-behaviors)).

_Разрешение_ - это доступ к определенному функционалу системы. Это может быть одна страница (статистика), а может быть набор страниц (просмотр, редактирование, удаление файла). 

Разрешение присваивается роли пользователя (админ, пользователь, модератор и т.д.). А  пользователю уже присваивается нужная роль.

Отдельно стоит такая вещь как _правила_. Правила применяются к разрешениям и служат для более гибкой настройки доступов. Это кусочек php-кода с доп. условиями.

Например, мы хотим разрешить просматривать требования к системе только пользователям, почта которых находится на gmail. Тогда создается разрешение на просмотр страницы требования, присваивается роли "пользователь", а к разрешению применяется правило, которое проверяет колонку user.email.

2. По миграциям. Всё в целом хорошо, вижу, что получилось написать для upload-таблицы. 

Остальное, видимо, было скопировано из dektrium-компонентов) Не то, чтобы это ошибка, но я бы советовала не копировать миграции из пакетов.

Обычно миграции из пакетов просто применяют через `php yii migrate --migrationPath="путь к папке с миграциями"` или настраивают карту контроллеров [как указано здесь](https://yiiframework.com.ua/ru/doc/guide/2/db-migrations/#namespaced-migrations)

3. Где используется `explode` всё же лучше сделать проверку, как я писала в прошлом ревью, чтобы исключить ошибки.

Из недостатков вроде всё, по коду всё понятно и чистенько. 

Из ТЗ __остаются только тесты__. Буду ждать, что получится)

<p align="center">
    <a href="https://github.com/yiisoft" target="_blank">
        <img src="https://avatars0.githubusercontent.com/u/993323" height="100px">
    </a>
    <h1 align="center">Приложение для хранения документов на PHP</h1>
    <h3 align="center">Необходимо разработать приложение, которое позволит организовывать хранение документов с различными разрешениями.</h3>
</p>

Требования к функционалу:
-------------------

○ Документы должны делиться на публичные (доступны «гостям»), условно-приватные (доступны авторизированным пользователям) и приватные (доступны только загрузившему пользователю).
</br>
○ Необходимо предусмотреть функционал авторизации и регистрации.
</br>
○ Необходимо вести некоторую статистику:
</br>
   − Сколько документов загружено в день / месяц / год
</br>
   − Соотношение публичных, условно-приватных и приватных документов за выбранный интервал времени.
</br>
○ Бекэнд должен быть написан на Yii2

Роли в системе:
-------------------

○ Гость – неавторизованный посетитель системы. Может просматривать публичные документы.
</br>
○ Необходимо предусмотреть функционал авторизации и регистрации.
</br>
○ Пользователь – посетитель, имеющий учетную запись в системе и авторизованный в ней. Может загружать свои документы, настраивать их приватность; просматривать публичные, условно-приватные и свои документы.
</br>
○ Администратор – пользователь, имеющий права на просмотр всех файлов и на управление другими пользователями.

Дополнительно (по желанию):
-------------------
○ Написание простых unit или acceptance тестов.